(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5524],{7535:function(e,t,s){Promise.resolve().then(s.bind(s,5065))},5065:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var n=s(7437),r=s(2265),i=s(7604),a=s(2869),l=s(4508);function o(){let[e,t]=(0,r.useState)(null),[s,o]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null);async function f(){try{var e,s;o(!0),m(null);let[n,r,i,a,l,c,d]=await Promise.all([fetch("/api/banner/students"),fetch("/api/banner/sections"),fetch("/api/banner/section-registrations"),fetch("/api/banner/academic-periods"),fetch("/api/banner/students").then(async e=>({json:async()=>[]})),fetch("/api/banner/student-transcript-grades"),fetch("/api/banner/academic-periods?status=active")]),u=await n.json(),f=await r.json(),x=await i.json(),h=await a.json(),g=await c.json(),p=h.map(e=>e.code).sort(),b=(null===(e=p[0])||void 0===e?void 0:e.substring(0,4))||"N/A",j=(null===(s=p[p.length-1])||void 0===s?void 0:s.substring(0,4))||"N/A",y="".concat(b,"-").concat(j),v={LOW:0,MEDIUM:0,HIGH:0};try{let e=await fetch("/api/banner/student-risks");if(e.ok)for(let t of(await e.json()))"LOW"===t.overallRiskBucket?v.LOW++:"MEDIUM"===t.overallRiskBucket?v.MEDIUM++:"HIGH"===t.overallRiskBucket&&v.HIGH++}catch(e){console.error("Failed to fetch risk data:",e)}let N=g.filter(e=>"final"===e.status&&null!==e.gradePoints),w={"<2.0":0,"2.0-2.5":0,"2.5-3.0":0,"3.0-3.5":0,"3.5+":0},A={};for(let e of N)A[e.student.id]||(A[e.student.id]={points:0,credits:0}),A[e.student.id].points+=Number(e.gradePoints||0)*Number(e.creditsEarned),A[e.student.id].credits+=Number(e.creditsEarned);for(let e in A){let{points:t,credits:s}=A[e];if(s>0){let e=t/s;e<2?w["<2.0"]++:e<2.5?w["2.0-2.5"]++:e<3?w["2.5-3.0"]++:e<3.5?w["3.0-3.5"]++:w["3.5+"]++}}let k=null;try{let e=await fetch("/api/internal/simulation-state");e.ok&&(k=(await e.json()).currentSimDate)}catch(e){console.error("Failed to fetch simulation state:",e)}t({students:u.length,sections:f.length,registrations:x.length,periods:h.length,yearsSpan:y,riskDistribution:v,gpaDistribution:w,currentSimDate:k})}catch(e){m(e instanceof Error?e.message:"Failed to load metrics")}finally{o(!1)}}async function x(){try{d(!0),m(null);let e=await fetch("/api/internal/simulator/tick",{method:"POST"}),t=await e.json();if(!e.ok)throw Error(t.error||"Simulation failed");await f()}catch(e){m(e instanceof Error?e.message:"Failed to run simulation")}finally{d(!1)}}return((0,r.useEffect)(()=>{f()},[]),s)?(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-spinner",className:"animate-spin h-5 w-5"}),(0,n.jsx)("span",{children:"Loading data health metrics..."})]})}):u&&!e?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-exclamation-circle",className:"h-12 w-12 mx-auto mb-4 text-red-500"}),(0,n.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:u}),(0,n.jsx)(a.z,{onClick:f,children:"Retry"})]}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"border-b border-gray-200 pb-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-chart-line",className:"h-8 w-8 text-[#336AEA]"}),"Data Health Dashboard"]}),(0,n.jsx)("p",{className:"text-gray-600 mt-1",children:"Dev / Internal - Affinity University SIS Metrics"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(null==e?void 0:e.currentSimDate)&&(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Simulation Date"}),(0,n.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:new Date(e.currentSimDate).toLocaleDateString()})]}),(0,n.jsx)(a.z,{onClick:x,disabled:c,className:"bg-[#336AEA] hover:bg-[#2a5bd4]",children:c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-spinner",className:"animate-spin mr-2"}),"Running..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-play",className:"mr-2"}),"Run Weekly Tick"]})})]})]})}),u&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-red-800",children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-exclamation-circle"}),(0,n.jsx)("span",{children:u})]})}),e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Total Students"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.students.toLocaleString()})]}),(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-user-graduate",className:"h-8 w-8 text-[#336AEA]"})]})}),(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Total Sections"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.sections.toLocaleString()})]}),(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-chalkboard",className:"h-8 w-8 text-[#336AEA]"})]})}),(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Registrations"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.registrations.toLocaleString()})]}),(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-clipboard-list",className:"h-8 w-8 text-[#336AEA]"})]})}),(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Academic Periods"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.periods}),(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Years: ",e.yearsSpan]})]}),(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-calendar",className:"h-8 w-8 text-[#336AEA]"})]})})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-exclamation-triangle",className:"h-5 w-5 text-[#336AEA]"}),"Risk Distribution (Current Term)"]}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-4",children:["LOW","MEDIUM","HIGH"].map(t=>{let s=e.riskDistribution[t],r=Object.values(e.riskDistribution).reduce((e,t)=>e+t,0),i=r>0?(s/r*100).toFixed(1):"0.0";return(0,n.jsxs)("div",{className:(0,l.cn)("rounded-lg p-4 border-2","LOW"===t&&"bg-green-50 border-green-200","MEDIUM"===t&&"bg-yellow-50 border-yellow-200","HIGH"===t&&"bg-red-50 border-red-200"),children:[(0,n.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[t," Risk"]}),(0,n.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:s.toLocaleString()}),(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[i,"%"]})]},t)})})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,n.jsx)(i.FontAwesomeIcon,{icon:"fa-solid fa-graduation-cap",className:"h-5 w-5 text-[#336AEA]"}),"GPA Distribution"]}),(0,n.jsx)("div",{className:"space-y-3",children:Object.entries(e.gpaDistribution).map(t=>{let[s,r]=t,i=Object.values(e.gpaDistribution).reduce((e,t)=>e+t,0),a=i>0?(r/i*100).toFixed(1):"0.0";return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-700",children:s}),(0,n.jsxs)("span",{className:"text-sm text-gray-600",children:[r.toLocaleString()," (",a,"%)"]})]}),(0,n.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,n.jsx)("div",{className:"bg-[#336AEA] h-2 rounded-full transition-all",style:{width:"".concat(i>0?r/i*100:0,"%")}})})]},s)})})]})]})]})}},2869:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var n=s(7437),r=s(2265),i=s(7495),a=s(535),l=s(4508);let o=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:a,asChild:c=!1,...d}=e,u=c?i.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(o({variant:r,size:a,className:s})),ref:t,...d})});c.displayName="Button"},7604:function(e,t,s){"use strict";s.d(t,{FontAwesomeIcon:function(){return r}});var n=s(7437);function r(e){let{icon:t,className:s="",size:r,style:i,"aria-hidden":a=!0}=e,l="".concat(t," ").concat(s).trim();return(0,n.jsx)("span",{style:{display:"contents",...i},"aria-hidden":a,children:(0,n.jsx)("i",{className:l,suppressHydrationWarning:!0})})}},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return i}});var n=s(1994),r=s(3335);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,n.W)(t))}},8575:function(e,t,s){"use strict";s.d(t,{F:function(){return i},e:function(){return a}});var n=s(2265);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function i(...e){return t=>{let s=!1,n=e.map(e=>{let n=r(e,t);return s||"function"!=typeof n||(s=!0),n});if(s)return()=>{for(let t=0;t<n.length;t++){let s=n[t];"function"==typeof s?s():r(e[t],null)}}}}function a(...e){return n.useCallback(i(...e),e)}},7495:function(e,t,s){"use strict";s.d(t,{Z8:function(){return a},g7:function(){return l}});var n=s(2265),r=s(8575),i=s(7437);function a(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:s,...i}=e;if(n.isValidElement(s)){let e,a;let l=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.props.ref:s.props.ref||s.ref,o=function(e,t){let s={...t};for(let n in t){let r=e[n],i=t[n];/^on[A-Z]/.test(n)?r&&i?s[n]=(...e)=>{let t=i(...e);return r(...e),t}:r&&(s[n]=r):"style"===n?s[n]={...r,...i}:"className"===n&&(s[n]=[r,i].filter(Boolean).join(" "))}return{...e,...s}}(i,s.props);return s.type!==n.Fragment&&(o.ref=t?(0,r.F)(t,l):l),n.cloneElement(s,o)}return n.Children.count(s)>1?n.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),s=n.forwardRef((e,s)=>{let{children:r,...a}=e,l=n.Children.toArray(r),o=l.find(c);if(o){let e=o.props.children,r=l.map(t=>t!==o?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...a,ref:s,children:n.isValidElement(e)?n.cloneElement(e,void 0,r):null})}return(0,i.jsx)(t,{...a,ref:s,children:r})});return s.displayName=`${e}.Slot`,s}var l=a("Slot"),o=Symbol("radix.slottable");function c(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},535:function(e,t,s){"use strict";s.d(t,{j:function(){return a}});var n=s(1994);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=n.W,a=(e,t)=>s=>{var n;if((null==t?void 0:t.variants)==null)return i(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:a,defaultVariants:l}=t,o=Object.keys(a).map(e=>{let t=null==s?void 0:s[e],n=null==l?void 0:l[e];if(null===t)return null;let i=r(t)||r(n);return a[e][i]}),c=s&&Object.entries(s).reduce((e,t)=>{let[s,n]=t;return void 0===n||(e[s]=n),e},{});return i(e,o,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:s,className:n,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...l,...c}[t]):({...l,...c})[t]===s})?[...e,s,n]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}}},function(e){e.O(0,[6137,2971,2117,1744],function(){return e(e.s=7535)}),_N_E=e.O()}]);
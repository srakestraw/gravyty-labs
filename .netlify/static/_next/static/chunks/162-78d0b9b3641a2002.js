"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[162],{162:function(e,t,s){s.d(t,{GuardrailsShell:function(){return W}});var a=s(7437),r=s(2265),i=s(9376),l=s(2869),n=s(7604),o=s(4508),c=s(5186);let d=["race","ethnicity","gender_identity","sexual_orientation","religion","national_origin","disability_status","age","veteran_status","first_generation_status","low_income"];function x(e){let{config:t,onChange:s,canEdit:i}=e,[l,o]=r.useState("");function x(e){!e.trim()||t.protectedAttributes.includes(e.trim())||(s({...t,protectedAttributes:[...t.protectedAttributes,e.trim()]}),o(""))}function u(){x(l)}return(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-4 shadow-sm space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Fairness & Inclusion"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Ensure fair and inclusive treatment across protected attributes. Prevent agents from using protected attributes to prioritize, exclude, or treat people differently. Focus decisions on behavior and engagement signals, not identity."})]})}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Protected attributes"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.protectedAttributes.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full bg-gray-50 px-2 py-0.5 text-[11px] text-gray-700 border border-gray-200",children:[e.replace(/_/g," "),i&&(0,a.jsx)("button",{type:"button",onClick:()=>{s({...t,protectedAttributes:t.protectedAttributes.filter(t=>t!==e)})},className:"ml-1 text-gray-400 hover:text-red-600",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-xmark",className:"h-3 w-3"})})]},e))}),i&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:d.filter(e=>!t.protectedAttributes.includes(e)).map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>x(e),className:"inline-flex items-center rounded-full border border-gray-300 bg-white px-2 py-0.5 text-[11px] text-gray-600 hover:bg-gray-50",children:["+ ",e.replace(/_/g," ")]},e))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.I,{type:"text",placeholder:"Custom attribute...",value:l,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),u())},className:"h-7 text-[11px]"}),(0,a.jsx)("button",{type:"button",onClick:u,className:"rounded border border-gray-300 bg-white px-2 py-1 text-[11px] text-gray-700 hover:bg-gray-50",children:"Add"})]})]}),(0,a.jsx)("p",{className:"mt-2 text-[11px] text-gray-500",children:"Agents must not segment, prioritize, or exclude based on these attributes, unless explicitly configured for approved support programs (for example, first-gen support)."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Language & bias guidance"}),i?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Discouraged phrasing"}),(0,a.jsx)("textarea",{value:t.languageGuidelines.avoidFraming.join("\n"),onChange:e=>{let a=e.target.value.split("\n").filter(e=>e.trim());s({...t,languageGuidelines:{...t.languageGuidelines,avoidFraming:a}})},placeholder:"low-quality student bad donor hopeless case",className:"w-full rounded border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-900",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Preferred phrasing"}),(0,a.jsx)("textarea",{value:t.languageGuidelines.preferredFraming.join("\n"),onChange:e=>{let a=e.target.value.split("\n").filter(e=>e.trim());s({...t,languageGuidelines:{...t.languageGuidelines,preferredFraming:a}})},placeholder:"students with fewer supports under-resourced students",className:"w-full rounded border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-900",rows:3})]})]}):(0,a.jsxs)("ul",{className:"text-[11px] text-gray-600 space-y-1",children:[t.languageGuidelines.avoidFraming.length>0&&(0,a.jsx)("li",{className:"font-medium",children:"Avoid:"}),t.languageGuidelines.avoidFraming.map((e,t)=>(0,a.jsxs)("li",{children:["• ",e]},t)),t.languageGuidelines.preferredFraming.length>0&&(0,a.jsx)("li",{className:"font-medium mt-2",children:"Prefer:"}),t.languageGuidelines.preferredFraming.map((e,t)=>(0,a.jsxs)("li",{children:["• ",e]},t))]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-100 pt-3 space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.allowAttributeOverrides,onChange:e=>s({...t,allowAttributeOverrides:e.target.checked}),disabled:!i,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-700",children:"Allow explicit, audited exceptions for research or support programs"})]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"When enabled, agents can use protected attributes only for explicitly approved programs (e.g., first-gen support, veteran services) with proper audit trails."})]}),(0,a.jsxs)("div",{className:"border-t border-gray-100 pt-3 space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.fairnessEvalsEnabled,onChange:e=>s({...t,fairnessEvalsEnabled:e.target.checked}),disabled:!i,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{className:"text-[11px] font-medium text-gray-700",children:"Run fairness evals on agents that take recruitment or outreach actions"})]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"We'll simulate behavior across protected groups and flag disparities."})]})]})}let u={admissions:"Admissions",registrar:"Registrar",student_success:"Student Success",career_services:"Career Services",alumni_engagement:"Alumni Engagement",advancement:"Advancement"},p=[{value:"summary_only",label:"Summary only"},{value:"no_sensitive",label:"No sensitive data"},{value:"restricted",label:"Restricted"},{value:"blocked",label:"Blocked"}];function m(e){let{config:t,onChange:s,canEdit:i}=e,[l,o]=r.useState("");function c(e){!e.trim()||t.sensitiveDomainsExcluded.includes(e.trim())||(s({...t,sensitiveDomainsExcluded:[...t.sensitiveDomainsExcluded,e.trim()]}),o(""))}return(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-4 shadow-sm space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Privacy & data scope"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Control which data domains agents can use and how much detail they can include per channel. These guardrails help align with FERPA and institutional policies."})]})}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Data domains (read-only)"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.allowedDomains.map(e=>(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-gray-50 px-2 py-0.5 text-[11px] text-gray-700 border border-gray-200",children:u[e]},e))}),(0,a.jsxs)("p",{className:"mt-2 text-[11px] text-gray-500",children:["Domains are managed centrally; guardrails control ",(0,a.jsx)("em",{children:"how"})," they're used, not what exists."]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Sensitive domains exclusion"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.sensitiveDomainsExcluded.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-50 px-2 py-0.5 text-[11px] text-red-700 border border-red-200",children:[e.replace(/_/g," "),i&&(0,a.jsx)("button",{type:"button",onClick:()=>{s({...t,sensitiveDomainsExcluded:t.sensitiveDomainsExcluded.filter(t=>t!==e)})},className:"ml-1 text-red-400 hover:text-red-600",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-xmark",className:"h-3 w-3"})})]},e))}),i&&(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"e.g., counseling_notes",value:l,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),c(l))},className:"flex-1 rounded border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-900"}),(0,a.jsx)("button",{type:"button",onClick:()=>c(l),className:"rounded border border-gray-300 bg-white px-2 py-1 text-[11px] text-gray-700 hover:bg-gray-50",children:"Add"})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-100 pt-3 space-y-3",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Channel content guidelines"}),(0,a.jsx)("div",{className:"grid gap-3 md:grid-cols-3",children:["email","sms","phone"].map(e=>{var r;let l="".concat(e,"Policy"),n=t[l];return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 capitalize",children:"phone"===e?"Phone / Robocall":e.toUpperCase()}),i?(0,a.jsx)("select",{value:n,onChange:e=>{s({...t,[l]:e.target.value})},className:"w-full rounded border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-900",children:p.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,a.jsx)("p",{className:"text-[11px] text-gray-600",children:(null===(r=p.find(e=>e.value===n))||void 0===r?void 0:r.label)||n}),"sms"===e||"phone"===e?(0,a.jsx)("p",{className:"text-[10px] text-gray-500",children:"No academic standing decisions, grades, or financial aid amounts."}):null]},e)})}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"Agents should never surface mental health notes, confidential documents, or conduct history in their responses."})]})]})}let g=[{value:"global",label:"Global"},{value:"admissions",label:"Admissions"},{value:"registrar",label:"Registrar"},{value:"student_success",label:"Student Success"},{value:"career_services",label:"Career Services"},{value:"alumni_engagement",label:"Alumni Engagement"},{value:"advancement",label:"Advancement"}],h=[{id:"agent-transcript-helper",name:"Transcript Helper Agent",priorityWeight:4},{id:"agent-registration-requirements",name:"Registration Requirements Agent",priorityWeight:4},{id:"agent-high-intent-prospect",name:"High-Intent Prospect Agent",priorityWeight:3},{id:"agent-donor-warmup",name:"Donor Warm-Up Agent",priorityWeight:2},{id:"agent-international-visa",name:"International Visa Docs Agent",priorityWeight:5}];function y(e){return({5:"Critical",4:"High",3:"Standard",2:"Low",1:"Informational"})[e]}function f(e){let{config:t,onChange:s,canEdit:i}=e,[l,o]=r.useState({label:"",startDate:"",endDate:""}),[d,x]=r.useState({label:"",date:"",scope:"global"}),[u,p]=r.useState(!1),[m,f]=r.useState(!1),[b,j]=r.useState(h),[v,N]=r.useState(t.priorityOverrides||{});return r.useEffect(()=>{},[]),r.useEffect(()=>{t.priorityOverrides&&N(t.priorityOverrides)},[t.priorityOverrides]),(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-4 shadow-sm space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Engagement & contact policy"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Define when agents are allowed to reach out. Do-Not-Engage lists are enforced separately; these settings control timing, seasonal pauses, and message frequency."})]})}),(0,a.jsxs)("div",{className:"space-y-2 border-b border-gray-100 pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Quiet hours"}),i&&(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.quietHours.enabled,onChange:e=>{s({...t,quietHours:{...t.quietHours,enabled:e.target.checked}})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-700",children:"Enforce quiet hours"})]})]}),t.quietHours.enabled?(0,a.jsx)("div",{className:"grid gap-2 md:grid-cols-3",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Start time"}),(0,a.jsx)(c.I,{type:"time",value:t.quietHours.startLocal,onChange:e=>{s({...t,quietHours:{...t.quietHours,startLocal:e.target.value}})},className:"h-7 text-[11px]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"End time"}),(0,a.jsx)(c.I,{type:"time",value:t.quietHours.endLocal,onChange:e=>{s({...t,quietHours:{...t.quietHours,endLocal:e.target.value}})},className:"h-7 text-[11px]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Timezone"}),(0,a.jsxs)("select",{value:t.quietHours.timezone||"recipient",onChange:e=>{s({...t,quietHours:{...t.quietHours,timezone:e.target.value}})},className:"w-full rounded border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"recipient",children:"Recipient timezone"}),(0,a.jsx)("option",{value:"institution",children:"Institution timezone"})]})]})]}):(0,a.jsxs)("p",{className:"text-[11px] text-gray-600",children:[t.quietHours.startLocal," to ",t.quietHours.endLocal," (",t.quietHours.timezone||"recipient"," timezone)"]})}):(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"Quiet hours are currently disabled."}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"Agents may still analyze data and create internal tasks during quiet hours, but they should not send email, SMS, or calls."})]}),(0,a.jsxs)("div",{className:"space-y-2 border-b border-gray-100 pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Seasonal quiet periods"}),i&&(0,a.jsx)("button",{type:"button",onClick:()=>p(!u),className:"text-[11px] text-indigo-600 hover:text-indigo-700",children:"+ Add quiet period"})]}),u&&i&&(0,a.jsxs)("div",{className:"rounded border border-gray-200 bg-gray-50 p-3 space-y-2",children:[(0,a.jsx)(c.I,{type:"text",placeholder:"Label (e.g., Finals week)",value:l.label||"",onChange:e=>o({...l,label:e.target.value}),className:"h-7 text-[11px]"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(c.I,{type:"date",placeholder:"Start date",value:l.startDate||"",onChange:e=>o({...l,startDate:e.target.value}),className:"h-7 text-[11px]"}),(0,a.jsx)(c.I,{type:"date",placeholder:"End date",value:l.endDate||"",onChange:e=>o({...l,endDate:e.target.value}),className:"h-7 text-[11px]"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:function(){l.label&&l.startDate&&l.endDate&&(s({...t,seasonalQuietPeriods:[...t.seasonalQuietPeriods,{id:"period-".concat(Date.now()),label:l.label,startDate:l.startDate,endDate:l.endDate}]}),o({label:"",startDate:"",endDate:""}),p(!1))},className:"rounded border border-indigo-300 bg-indigo-50 px-2 py-1 text-[11px] text-indigo-700 hover:bg-indigo-100",children:"Add"}),(0,a.jsx)("button",{type:"button",onClick:()=>{p(!1),o({label:"",startDate:"",endDate:""})},className:"rounded border border-gray-300 bg-white px-2 py-1 text-[11px] text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]}),0===t.seasonalQuietPeriods.length?(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"No seasonal quiet periods configured yet. Use these to pause proactive outreach during finals, institutional breaks, or other sensitive windows."}):(0,a.jsx)("div",{className:"space-y-1",children:t.seasonalQuietPeriods.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded border border-gray-100 bg-gray-50 px-2 py-1",children:[(0,a.jsxs)("span",{className:"text-[11px] text-gray-700",children:[e.label," (",e.startDate," → ",e.endDate,")"]}),i&&(0,a.jsx)("button",{type:"button",onClick:()=>{var a;return a=e.id,void s({...t,seasonalQuietPeriods:t.seasonalQuietPeriods.filter(e=>e.id!==a)})},className:"text-[11px] text-red-600 hover:text-red-800",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-trash",className:"h-3 w-3"})})]},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-2 border-b border-gray-100 pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Sensitive dates & holidays"}),i&&(0,a.jsx)("button",{type:"button",onClick:()=>f(!m),className:"text-[11px] text-indigo-600 hover:text-indigo-700",children:"+ Add holiday"})]}),m&&i&&(0,a.jsxs)("div",{className:"rounded border border-gray-200 bg-gray-50 p-3 space-y-2",children:[(0,a.jsx)(c.I,{type:"text",placeholder:"Label (e.g., Memorial Day)",value:d.label||"",onChange:e=>x({...d,label:e.target.value}),className:"h-7 text-[11px]"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(c.I,{type:"date",placeholder:"Date",value:d.date||"",onChange:e=>x({...d,date:e.target.value}),className:"h-7 text-[11px]"}),(0,a.jsx)("select",{value:d.scope||"global",onChange:e=>x({...d,scope:e.target.value}),className:"rounded border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-900",children:g.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:function(){d.label&&d.date&&(s({...t,holidayRules:[...t.holidayRules,{id:"holiday-".concat(Date.now()),label:d.label,date:d.date,scope:d.scope||"global"}]}),x({label:"",date:"",scope:"global"}),f(!1))},className:"rounded border border-indigo-300 bg-indigo-50 px-2 py-1 text-[11px] text-indigo-700 hover:bg-indigo-100",children:"Add"}),(0,a.jsx)("button",{type:"button",onClick:()=>{f(!1),x({label:"",date:"",scope:"global"})},className:"rounded border border-gray-300 bg-white px-2 py-1 text-[11px] text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]}),0===t.holidayRules.length?(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"No sensitive dates configured yet. Consider adding key holidays and days of mourning where solicitations should be paused or restricted to supportive messaging."}):(0,a.jsx)("div",{className:"space-y-1",children:t.holidayRules.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded border border-gray-100 bg-gray-50 px-2 py-1",children:[(0,a.jsxs)("span",{className:"text-[11px] text-gray-700",children:[e.label," (",e.date,") - ","global"===e.scope?"Global":e.scope]}),i&&(0,a.jsx)("button",{type:"button",onClick:()=>{var a;return a=e.id,void s({...t,holidayRules:t.holidayRules.filter(e=>e.id!==a)})},className:"text-[11px] text-red-600 hover:text-red-800",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-trash",className:"h-3 w-3"})})]},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Frequency caps"}),(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Global limit: messages per week per person"}),i?(0,a.jsx)(c.I,{type:"number",min:"1",value:t.frequencyCaps.globalMaxMessagesPerWeek,onChange:e=>{s({...t,frequencyCaps:{...t.frequencyCaps,globalMaxMessagesPerWeek:parseInt(e.target.value)||0}})},className:"h-7 text-[11px]"}):(0,a.jsx)("p",{className:"text-[11px] text-gray-600",children:t.frequencyCaps.globalMaxMessagesPerWeek})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Global limit: messages per day per person"}),i?(0,a.jsx)(c.I,{type:"number",min:"1",value:t.frequencyCaps.globalMaxMessagesPerDay,onChange:e=>{s({...t,frequencyCaps:{...t.frequencyCaps,globalMaxMessagesPerDay:parseInt(e.target.value)||0}})},className:"h-7 text-[11px]"}):(0,a.jsx)("p",{className:"text-[11px] text-gray-600",children:t.frequencyCaps.globalMaxMessagesPerDay})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Default agent limit: messages in 14 days"}),i?(0,a.jsx)(c.I,{type:"number",min:"1",value:t.frequencyCaps.perAgentDefaultMaxIn14Days,onChange:e=>{s({...t,frequencyCaps:{...t.frequencyCaps,perAgentDefaultMaxIn14Days:parseInt(e.target.value)||0}})},className:"h-7 text-[11px]"}):(0,a.jsx)("p",{className:"text-[11px] text-gray-600",children:t.frequencyCaps.perAgentDefaultMaxIn14Days})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Escalate to human after unanswered attempts"}),i?(0,a.jsx)(c.I,{type:"number",min:"1",value:t.frequencyCaps.maxUnansweredAttemptsBeforeEscalation,onChange:e=>{s({...t,frequencyCaps:{...t.frequencyCaps,maxUnansweredAttemptsBeforeEscalation:parseInt(e.target.value)||0}})},className:"h-7 text-[11px]"}):(0,a.jsx)("p",{className:"text-[11px] text-gray-600",children:t.frequencyCaps.maxUnansweredAttemptsBeforeEscalation})]})]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"These limits help ensure a positive student experience and avoid over-contact."})]}),(0,a.jsxs)("div",{className:"mt-4 space-y-3 border-t border-gray-100 pt-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Agent priority weighting"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Use weights to decide which agents send messages first when global limits are reached. Higher-priority agents will consume available message slots before lower-priority agents."})]}),(0,a.jsx)("div",{className:"overflow-hidden rounded-lg border border-gray-100 bg-gray-50",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-100 text-xs",children:[(0,a.jsx)("thead",{className:"bg-gray-100 text-[11px] font-medium uppercase tracking-wide text-gray-500",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left",children:"Agent"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left",children:"Current priority"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left",children:"Override (optional)"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left",children:"Notes"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-100 bg-white",children:b.map(e=>{var r;let l=null!==(r=v[e.id])&&void 0!==r?r:e.priorityWeight;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-3 py-2 text-gray-900",children:e.name}),(0,a.jsx)("td",{className:"px-3 py-2 text-gray-600",children:y(e.priorityWeight)}),(0,a.jsx)("td",{className:"px-3 py-2",children:i?(0,a.jsxs)("select",{className:"w-full rounded-md border border-gray-200 bg-gray-50 px-2 py-1 text-[11px] text-gray-800 focus:border-indigo-400 focus:outline-none focus:ring-1 focus:ring-indigo-200",value:l,onChange:a=>(function(e,a){let r=b.find(t=>t.id===e);if(!r)return;let i={...v};a===r.priorityWeight?delete i[e]:i[e]=a,N(i),s({...t,priorityOverrides:Object.keys(i).length>0?i:void 0})})(e.id,Number(a.target.value)),children:[(0,a.jsx)("option",{value:5,children:"Critical (5)"}),(0,a.jsx)("option",{value:4,children:"High (4)"}),(0,a.jsx)("option",{value:3,children:"Standard (3)"}),(0,a.jsx)("option",{value:2,children:"Low (2)"}),(0,a.jsx)("option",{value:1,children:"Informational (1)"})]}):(0,a.jsx)("span",{className:"text-[11px] text-gray-600",children:y(l)})}),(0,a.jsx)("td",{className:"px-3 py-2 text-[11px] text-gray-500",children:"Higher priority agents use message slots first if caps are reached."})]},e.id)})})]})}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"These settings do not change your global caps. They control how agents share the limited message budget when caps or quiet hours restrict outreach."})]})]})}let b={send_email:"Send email messages using institutional templates",send_sms:"Send short text messages to students, alumni, or donors",send_phone_call:"Trigger automated voice calls using pre-approved scripts",create_task:"Create follow-up tasks for advisors, success staff, or gift officers",create_internal_flag:"Apply internal flags so staff can see risk, priority, or status",change_status:"Change student or prospect status in CRM",change_owner:"Change advisor or owner assignment"},j=[{value:"auto",label:"Auto (Safe Mode)",description:"Agent may act automatically when all guardrails are satisfied"},{value:"human_review",label:"Human review",description:"Agent drafts, a person approves"},{value:"blocked",label:"Blocked",description:"Agent may never perform this action"}];function v(e){let{children:t,content:s}=e,[i,l]=r.useState(!1);return(0,a.jsxs)("span",{className:"relative inline-block",children:[(0,a.jsx)("span",{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),className:"cursor-help",children:t}),i&&(0,a.jsxs)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-50 w-64 rounded-lg border border-gray-200 bg-white p-2 shadow-lg text-xs text-gray-700",children:[s,(0,a.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-200"}),(0,a.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-[5px] border-4 border-transparent border-t-white"})]})]})}function N(e){let{config:t,onChange:s,canEdit:r}=e,i=["change_status","change_owner"];return(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-4 shadow-sm space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Actions & autonomy"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Control which actions agents can take automatically versus when a human must approve."})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wide text-gray-500",children:"Default action modes"}),(0,a.jsxs)("p",{className:"mt-1 text-xs text-gray-600",children:[(0,a.jsx)("span",{className:"font-semibold",children:"About Auto (Safe Mode):"})," ","When an action is set to ",(0,a.jsx)("span",{className:"font-semibold",children:"Auto"}),", the agent may perform it automatically ",(0,a.jsx)("em",{children:"only"})," when all guardrails are satisfied — including safety rules, escalation triggers, do-not-engage lists, quiet hours, seasonal pauses, and frequency caps. If any guardrail blocks the action, it will pause and route to human review instead."]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-[11px]",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,a.jsx)("th",{className:"text-left py-2 px-2 font-medium text-gray-700",children:"Action"}),(0,a.jsx)("th",{className:"text-left py-2 px-2 font-medium text-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"Mode"}),(0,a.jsx)(v,{content:(0,a.jsxs)("div",{className:"max-w-xs",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"Auto (Safe Mode)"}),(0,a.jsx)("p",{children:"Auto means the agent may perform this action automatically when all global and agent-level guardrails allow it. If a safety rule, quiet hour, do-not-engage flag, escalation trigger, or frequency limit applies, the action is paused and sent for human review instead."})]}),children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-circle-question",className:"h-3 w-3 text-gray-400"})})]})}),(0,a.jsx)("th",{className:"text-left py-2 px-2 font-medium text-gray-700",children:"Description"})]})}),(0,a.jsx)("tbody",{children:t.rules.map(e=>{var l;let n=i.includes(e.actionKey);return(0,a.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,a.jsxs)("td",{className:"py-2 px-2",children:[(0,a.jsx)("code",{className:"text-[10px] text-gray-600",children:e.actionKey}),n&&(0,a.jsx)("span",{className:"ml-2 text-[10px] text-amber-600",children:"⚠ Sensitive"})]}),(0,a.jsx)("td",{className:"py-2 px-2",children:r?(0,a.jsx)("select",{value:e.mode,onChange:a=>{var r,i;return r=e.actionKey,i=a.target.value,void s({...t,rules:t.rules.map(e=>e.actionKey===r?{...e,mode:i}:e)})},className:"rounded border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-900",children:j.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,a.jsx)("span",{className:"font-medium text-gray-700",children:(null===(l=j.find(t=>t.value===e.mode))||void 0===l?void 0:l.label)||e.mode})}),(0,a.jsx)("td",{className:"py-2 px-2 text-gray-600",children:b[e.actionKey]||"No description"})]},e.actionKey)})})]})}),r&&(0,a.jsxs)("p",{className:"mt-2 flex items-start gap-1 text-[11px] text-amber-700",children:[(0,a.jsx)("span",{className:"mt-0.5 text-xs",children:"⚠️"}),(0,a.jsxs)("span",{children:["Setting sensitive actions (like status or owner changes) to"," ",(0,a.jsx)("span",{className:"font-semibold",children:"Auto (Safe Mode)"})," may still affect a student's standing or finances. Human review is strongly recommended unless you have strict upstream controls."]})]})]})]})}function w(e){let{rules:t,onChange:s,canEdit:r}=e;function i(e,a){s(t.map(t=>t.id===e?{...t,...a}:t))}function l(e,s,a){let r=t.find(t=>t.id===e);if(!r)return;let l=[...r.targets||[]];l[s]?l[s]={...l[s],...a}:l[s]={id:"target-".concat(Date.now(),"-").concat(s),type:"group"===r.routingStrategy?"group":"person",channels:[],...a},i(e,{targets:l})}function n(e,s){var i;let n=null===(i=e.targets)||void 0===i?void 0:i[s],c=(null==n?void 0:n.channels)||[];return(0,a.jsx)("div",{className:"flex flex-wrap gap-1.5 mt-1",children:["email","sms","voice","ticket"].map(i=>{let n=c.includes(i);return(0,a.jsx)("button",{type:"button",onClick:()=>(function(e,s,a){let r=t.find(t=>t.id===e);if(!r||!r.targets||!r.targets[s])return;let i=r.targets[s].channels||[];l(e,s,{channels:i.includes(a)?i.filter(e=>e!==a):[...i,a]})})(e.id,s,i),disabled:!r,className:(0,o.cn)("rounded-full border px-2 py-0.5 text-[10px] transition-colors",n?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300",!r&&"opacity-50 cursor-not-allowed"),children:"ticket"===i?"Ticket only":i.toUpperCase()},i)})})}return(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-4 shadow-sm space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Human escalation rules"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Define when agents must pause automation and involve a human - for safety, threats, mental health concerns, or other high-risk situations."})]})}),(0,a.jsx)("div",{className:"space-y-3 text-xs",children:t.map(e=>{var s,o,c,d,x;let u={...e,behaviorMode:e.behaviorMode||"pause_and_message",routingStrategy:e.routingStrategy||"single",targets:e.targets&&e.targets.length>0?e.targets:[{id:"target-default-".concat(e.id),type:"group"===(e.routingStrategy||"single")?"group":"person",channels:[],label:""}]};return(0,a.jsxs)("div",{className:"rounded-lg border border-gray-100 bg-gray-50 p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-900",children:e.label}),(0,a.jsx)("p",{className:"text-[11px] text-gray-600",children:e.description})]}),(0,a.jsxs)("label",{className:"inline-flex items-center gap-1 text-[11px] cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:t=>i(e.id,{enabled:t.target.checked}),disabled:!r,className:"h-3 w-3 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{children:e.enabled?"Enabled":"Disabled"})]})]}),(0,a.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-gray-500",children:"Agent behavior"}),(0,a.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700",children:"When this rule triggers, the agent should:"}),(0,a.jsxs)("select",{className:"w-full rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-800 focus:border-indigo-400 focus:outline-none focus:ring-1 focus:ring-indigo-200",value:u.behaviorMode,onChange:t=>i(e.id,{behaviorMode:t.target.value}),disabled:!r,children:[(0,a.jsx)("option",{value:"pause_and_message",children:"Pause automation & send a supportive message"}),(0,a.jsx)("option",{value:"pause_only",children:"Pause automation and hand off to a human, no automated reply"}),(0,a.jsx)("option",{value:"log_only",children:"Log the event only (no student-facing response)"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700",children:"Additional safeguards"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)("label",{className:"inline-flex items-center gap-1",children:[(0,a.jsx)("input",{type:"checkbox",className:"h-3 w-3",checked:!!u.suppressOutboundHours,onChange:t=>i(e.id,{suppressOutboundHours:t.target.checked?24:void 0}),disabled:!r}),(0,a.jsx)("span",{className:"text-[11px] text-gray-700",children:"Suppress outbound messages for 24 hours"})]}),(0,a.jsxs)("label",{className:"inline-flex items-center gap-1",children:[(0,a.jsx)("input",{type:"checkbox",className:"h-3 w-3",checked:!!u.addPriorityTag,onChange:t=>i(e.id,{addPriorityTag:t.target.checked}),disabled:!r}),(0,a.jsx)("span",{className:"text-[11px] text-gray-700",children:"Tag as high priority"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-gray-500",children:"Routing & contacts"}),(0,a.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700",children:"Routing strategy"}),(0,a.jsxs)("select",{className:"w-full rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-800 focus:border-indigo-400 focus:outline-none focus:ring-1 focus:ring-indigo-200",value:u.routingStrategy,onChange:t=>{let s=t.target.value;i(e.id,{routingStrategy:s,targets:[{id:"target-".concat(Date.now()),type:"group"===s?"group":"person",channels:[],label:""}]})},disabled:!r,children:[(0,a.jsx)("option",{value:"single",children:"Notify a single contact"}),(0,a.jsx)("option",{value:"group",children:"Notify a group (broadcast)"}),(0,a.jsx)("option",{value:"chain",children:"Escalation chain (try A, then B, then C)"})]}),(0,a.jsx)("p",{className:"text-[10px] text-gray-500",children:"Choose whether to alert one person, a group, or escalate through a sequence of contacts."})]}),(0,a.jsxs)("div",{className:"text-[10px] text-gray-500",children:[(0,a.jsx)("p",{className:"font-medium text-gray-700",children:"Channels"}),(0,a.jsx)("p",{children:"For each contact, choose which channels to use: email, SMS, voice call, or ticket-only. Voice can map to a campus safety line or other emergency number configured elsewhere."})]})]}),"chain"===u.routingStrategy?(0,a.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium text-gray-700",children:"Escalation steps"}),(0,a.jsx)("div",{className:"space-y-2",children:null===(s=u.targets)||void 0===s?void 0:s.map((s,o)=>{var c,d;return(0,a.jsxs)("div",{className:"rounded-md border border-gray-100 bg-white p-2 space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("p",{className:"text-[11px] font-medium text-gray-800",children:["Step ",o+1]}),u.targets&&u.targets.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>(function(e,s){let a=t.find(t=>t.id===e);a&&a.targets&&i(e,{targets:a.targets.filter((e,t)=>t!==s)})})(e.id,o),disabled:!r,className:"text-[10px] text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Remove"})]}),(0,a.jsx)("input",{className:"w-full rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-800 focus:border-indigo-400 focus:outline-none focus:ring-1 focus:ring-indigo-200",placeholder:"e.g., Student Care On-Call",value:null!==(c=s.label)&&void 0!==c?c:"",onChange:t=>l(e.id,o,{label:t.target.value}),disabled:!r}),n(u,o),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-[11px] text-gray-700",children:"Timeout before next step (minutes):"}),(0,a.jsx)("input",{type:"number",min:0,className:"w-20 rounded-md border border-gray-200 bg-white px-2 py-0.5 text-[11px] text-gray-800 focus:border-indigo-400 focus:outline-none focus:ring-1 focus:ring-indigo-200",value:null!==(d=s.timeoutMinutes)&&void 0!==d?d:"",onChange:t=>l(e.id,o,{timeoutMinutes:t.target.value?Number(t.target.value):void 0}),disabled:!r})]})]},s.id||o)})}),(0,a.jsx)("button",{type:"button",onClick:()=>(function(e){let s=t.find(t=>t.id===e);if(!s)return;let a=s.targets||[],r={id:"target-".concat(Date.now(),"-").concat(a.length),type:"group"===s.routingStrategy?"group":"person",channels:[],label:""};i(e,{targets:[...a,r]})})(e.id),disabled:!r,className:"text-[11px] text-indigo-600 hover:text-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"+ Add escalation step"})]}):(0,a.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium text-gray-700",children:"group"===u.routingStrategy?"Recipient group":"Primary contact"}),(0,a.jsx)("input",{className:"w-full rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-800 focus:border-indigo-400 focus:outline-none focus:ring-1 focus:ring-indigo-200",placeholder:"group"===u.routingStrategy?"e.g., Student Care Team":"e.g., On-call counselor",value:null!==(d=null===(c=u.targets)||void 0===c?void 0:null===(o=c[0])||void 0===o?void 0:o.label)&&void 0!==d?d:"",onChange:t=>l(e.id,0,{label:t.target.value,type:"group"===u.routingStrategy?"group":"person"}),disabled:!r}),n(u,0)]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-gray-500",children:"Optional message to the student"}),(0,a.jsx)("textarea",{className:"w-full rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-800 focus:border-indigo-400 focus:outline-none focus:ring-1 focus:ring-indigo-200",rows:2,value:null!==(x=e.templateMessage)&&void 0!==x?x:"",onChange:t=>i(e.id,{templateMessage:t.target.value}),disabled:!r,placeholder:'Example: "Because of what you shared, I am connecting you with someone who can help right away."'})]})]},e.id)})})]})}function k(e){let{config:t,onChange:s,canEdit:r}=e;return(0,a.jsxs)("section",{className:"space-y-3 rounded-xl border border-gray-100 bg-white p-4 shadow-sm",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Logging & eval expectations"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Configure what agent actions should be logged and when evaluations are required."})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.loggingRequired,onChange:e=>s({...t,loggingRequired:e.target.checked}),disabled:!r,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-700",children:"Log all agent actions with who, when, and why"})]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500 ml-6",children:"All agent actions should be logged with who, when, and why for audit and compliance purposes."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.requireEvalBeforeAuto,onChange:e=>s({...t,requireEvalBeforeAuto:e.target.checked}),disabled:!r,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-700",children:"Require eval/fairness checks before agents can act automatically"})]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500 ml-6",children:"Agents should pass safety/fairness evals before auto-actions are enabled. This helps ensure consistent behavior across protected groups and flag disparities."})]}),(0,a.jsx)("div",{className:"border-t border-gray-100 pt-3",children:(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"Human review is recommended for any action that could materially affect a student's standing or finances."})})]})]})}function C(e){let{config:t}=e,s=t.fairness.fairnessEvalsEnabled,r=t.engagement.quietHours.enabled,i=t.actions.rules.filter(e=>"auto"===e.mode).length,l=t.actions.rules.filter(e=>"blocked"===e.mode).length,o=t.actions.rules.filter(e=>"human_review"===e.mode).length;return(0,a.jsxs)("section",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Guardrails Summary"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Overview of your current guardrails configuration."})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-lg border border-gray-100 bg-white p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-shield-halved",className:"h-4 w-4 text-indigo-600"}),(0,a.jsx)("h3",{className:"text-xs font-semibold text-gray-900",children:"Fairness & Inclusion"})]}),(0,a.jsxs)("ul",{className:"text-[11px] text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:["• ",t.fairness.protectedAttributes.length," protected attributes"]}),(0,a.jsxs)("li",{children:["• ",t.fairness.languageGuidelines.avoidFraming.length," discouraged phrases"]}),(0,a.jsxs)("li",{children:["• ",t.fairness.languageGuidelines.preferredFraming.length," preferred phrases"]}),(0,a.jsxs)("li",{children:["• Fairness evals: ",s?"Enabled":"Disabled"]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-gray-100 bg-white p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-lock",className:"h-4 w-4 text-indigo-600"}),(0,a.jsx)("h3",{className:"text-xs font-semibold text-gray-900",children:"Privacy & Data"})]}),(0,a.jsxs)("ul",{className:"text-[11px] text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:["• ",t.privacy.allowedDomains.length," data domains allowed"]}),(0,a.jsxs)("li",{children:["• ",t.privacy.sensitiveDomainsExcluded.length," sensitive domains excluded"]}),(0,a.jsxs)("li",{children:["• Email: ",t.privacy.emailPolicy]}),(0,a.jsxs)("li",{children:["• SMS: ",t.privacy.smsPolicy]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-gray-100 bg-white p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-clock",className:"h-4 w-4 text-indigo-600"}),(0,a.jsx)("h3",{className:"text-xs font-semibold text-gray-900",children:"Engagement"})]}),(0,a.jsxs)("ul",{className:"text-[11px] text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:["• Quiet hours: ",r?"Enabled":"Disabled"]}),(0,a.jsxs)("li",{children:["• ",t.engagement.seasonalQuietPeriods.length," seasonal quiet periods"]}),(0,a.jsxs)("li",{children:["• ",t.engagement.holidayRules.length," holiday rules"]}),(0,a.jsxs)("li",{children:["• Max ",t.engagement.frequencyCaps.globalMaxMessagesPerDay," messages/day per person"]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-gray-100 bg-white p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-bolt",className:"h-4 w-4 text-indigo-600"}),(0,a.jsx)("h3",{className:"text-xs font-semibold text-gray-900",children:"Actions"})]}),(0,a.jsxs)("ul",{className:"text-[11px] text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:["• ",i," actions set to Auto (Safe Mode)"]}),(0,a.jsxs)("li",{children:["• ",o," actions require human review"]}),(0,a.jsxs)("li",{children:["• ",l," actions blocked"]}),(0,a.jsxs)("li",{children:["• Logging: ",t.actions.loggingRequired?"Required":"Optional"]})]})]})]})]})}let S=[{id:"summary",label:"Summary"},{id:"fairness",label:"Fairness & Inclusion"},{id:"privacy",label:"Privacy & data scope"},{id:"engagement",label:"Engagement & contact policy"},{id:"actions",label:"Actions & autonomy"},{id:"escalation",label:"Human escalation rules"},{id:"logging",label:"Logging & eval expectations"}],A=[{id:"self_harm",category:"self_harm",label:"Self-harm or suicide risk",description:"If a student expresses self-harm or suicidal ideation, the agent must pause and route to a human immediately.",enabled:!0,actions:["pause_agent","assign_to_human","notify_team"],behaviorMode:"pause_and_message",addPriorityTag:!0,routingStrategy:"single",targets:[{id:"target-self-harm-default",type:"person",label:"Crisis Counselor On-Call",channels:["email","sms","voice"]}],templateMessage:"Because of what you shared, I'm connecting you with a person who can support you right away."},{id:"threat_to_others",category:"threat_to_others",label:"Threats of violence or harm to others",description:"Any credible threat to others should trigger an immediate handoff to campus safety or designated responders.",enabled:!0,actions:["pause_agent","assign_to_human","notify_team"],behaviorMode:"pause_only",addPriorityTag:!0,routingStrategy:"chain",targets:[{id:"target-threat-1",type:"person",label:"Campus Safety",channels:["voice","sms"],timeoutMinutes:5},{id:"target-threat-2",type:"person",label:"Dean of Students",channels:["email","sms"],timeoutMinutes:15}]},{id:"harassment",category:"harassment",label:"Harassment or Title IX-related content",description:"Reports of harassment, discrimination, or sexual misconduct must route to the appropriate Title IX or HR contact.",enabled:!0,actions:["pause_agent","assign_to_human"],behaviorMode:"pause_and_message",routingStrategy:"single",targets:[{id:"target-harassment-default",type:"person",label:"Title IX Coordinator",channels:["email","ticket"]}]},{id:"mental_health_distress",category:"mental_health_distress",label:"Acute mental health distress",description:"When a student sounds overwhelmed, panicked, or in emotional crisis, the agent should escalate instead of giving advice.",enabled:!0,actions:["pause_agent","assign_to_human"],behaviorMode:"pause_and_message",routingStrategy:"single",targets:[{id:"target-mental-health-default",type:"person",label:"Student Care Counselor",channels:["email","sms"]}]},{id:"financial_crisis",category:"financial_crisis",label:"Severe financial or housing insecurity",description:"Escalate to a person for complex financial aid or emergency support situations.",enabled:!0,actions:["assign_to_human"],behaviorMode:"pause_and_message",routingStrategy:"group",targets:[{id:"target-financial-default",type:"group",label:"Financial Aid Emergency Team",channels:["email","ticket"]}]},{id:"academic_risk",category:"academic_risk",label:"Serious academic risk",description:"Route to a human advisor when the student indicates they may fail, withdraw, or lose status.",enabled:!1,actions:["assign_to_human"],behaviorMode:"pause_and_message",routingStrategy:"single",targets:[{id:"target-academic-default",type:"person",label:"Academic Advisor",channels:["email"]}]}];function I(){let[e,t]=r.useState(null),[s,i]=r.useState(null),[c,d]=r.useState(A),[u,p]=r.useState(A),[g,h]=r.useState(!0),[y,b]=r.useState(!1),[j,v]=r.useState(null),[I,D]=r.useState("saved"),[_,E]=r.useState("summary"),P=r.useRef(null),[F,R]=r.useState(80);async function q(){try{var e,s;h(!0),v(null);let a=await fetch("/api/guardrails");if(!a.ok)throw Error("Failed to load guardrails");let r=await a.json();t(r.config),i(JSON.parse(JSON.stringify(r.config)));let l=(null===(s=r.config)||void 0===s?void 0:null===(e=s.humanEscalation)||void 0===e?void 0:e.rules)||A;d(JSON.parse(JSON.stringify(l))),p(JSON.parse(JSON.stringify(l))),D("saved")}catch(e){console.error("Error loading guardrails:",e),v(e instanceof Error?e.message:"Failed to load guardrails")}finally{h(!1)}}async function M(){if(e){b(!0),v(null);try{let s={...e,humanEscalation:{rules:u}},a=await fetch("/api/guardrails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:s})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to save guardrails")}let r=await a.json();t(r.config),i(JSON.parse(JSON.stringify(r.config))),d(JSON.parse(JSON.stringify(u))),D("saved"),alert("Guardrails saved successfully")}catch(e){console.error("Error saving guardrails:",e),v(e instanceof Error?e.message:"Failed to save guardrails"),D("error")}finally{b(!1)}}}function O(s){e&&t(s(e))}return r.useEffect(()=>{q()},[]),r.useEffect(()=>{P.current&&R(P.current.offsetHeight+16)},[]),r.useEffect(()=>{if(!e||!s)return;let t=JSON.stringify(e)!==JSON.stringify(s),a=JSON.stringify(u)!==JSON.stringify(c),r=t||a;r&&"saved"===I?D("unsaved"):r||"unsaved"!==I||D("saved")},[e,s,u,c,I]),g?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)("div",{className:"p-6 text-center text-gray-600",children:"Loading guardrails configuration..."})}):e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-info-circle",className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Global Guardrails"}),(0,a.jsx)("p",{className:"text-xs text-blue-800",children:"Global Guardrails apply to all assistants, apps, agents, groups, and users. Policies can narrow or tailor behavior for specific contexts but must respect core safety, fairness, privacy, and escalation requirements defined here."})]})]})}),(0,a.jsxs)("div",{ref:P,className:"sticky top-0 z-10 flex items-center justify-between rounded-lg border border-gray-200 bg-white px-4 py-3 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["saved"===I&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-check-circle",className:"h-4 w-4 text-green-600"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:"All changes saved"})]}),"unsaved"===I&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-circle-exclamation",className:"h-4 w-4 text-amber-600"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:"Unsaved changes"})]}),"error"===I&&j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-triangle-exclamation",className:"h-4 w-4 text-red-600"}),(0,a.jsx)("span",{className:"text-sm text-red-700",children:j})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.z,{variant:"ghost",onClick:function(){s&&(t(JSON.parse(JSON.stringify(s))),p(JSON.parse(JSON.stringify(c))),D("saved"),v(null))},disabled:"saved"===I||y,className:"text-sm",children:"Discard changes"}),(0,a.jsx)(l.z,{onClick:M,disabled:"saved"===I||y,className:"text-sm",children:y?"Saving...":"Save changes"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-[220px,1fr]",children:[(0,a.jsx)("nav",{className:"sticky self-start z-20 max-h-[calc(100vh-6rem)] overflow-y-auto space-y-1 rounded-xl border border-gray-100 bg-white p-2 text-sm",style:{top:"".concat(F,"px")},children:S.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>E(e.id),className:(0,o.cn)("flex w-full items-center justify-between rounded-md px-3 py-2 text-left text-xs transition-colors",_===e.id?"bg-gray-900 text-white":"text-gray-700 hover:bg-gray-50"),children:(0,a.jsx)("span",{children:e.label})},e.id))}),(0,a.jsxs)("section",{className:"space-y-4",children:["summary"===_&&e&&(0,a.jsx)(C,{config:e}),"fairness"===_&&e&&(0,a.jsx)(x,{config:e.fairness,onChange:e=>O(t=>({...t,fairness:e})),canEdit:!0}),"privacy"===_&&e&&(0,a.jsx)(m,{config:e.privacy,onChange:e=>O(t=>({...t,privacy:e})),canEdit:!0}),"engagement"===_&&e&&(0,a.jsx)(f,{config:e.engagement,onChange:e=>O(t=>({...t,engagement:e})),canEdit:!0}),"actions"===_&&e&&(0,a.jsx)(N,{config:e.actions,onChange:e=>O(t=>({...t,actions:e})),canEdit:!0}),"escalation"===_&&(0,a.jsx)(w,{rules:u,onChange:p,canEdit:!0}),"logging"===_&&e&&(0,a.jsx)(k,{config:e.actions,onChange:e=>O(t=>({...t,actions:e})),canEdit:!0})]})]})]}):(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"p-6 text-center text-red-600",children:[j||"Failed to load guardrails configuration",(0,a.jsx)(l.z,{onClick:q,className:"mt-4",children:"Retry"})]})})}function D(e){let{policies:t,assignmentRules:s,onUpdatePolicies:i,onUpdateAssignmentRules:o,onSelectPolicy:d,onCreatePolicy:x,basePath:u="/admin/guardrails",loading:p=!1}=e,[m,g]=r.useState(!1),[h,y]=r.useState(""),[f,b]=r.useState(""),[j,v]=r.useState(null),[N,w]=r.useState(null),[k,C]=r.useState(!1);async function S(){if(!h.trim()||k)return;let e=j?t.find(e=>e.id===j):t.find(e=>e.isDefault)||t[0];C(!0);try{let s={...e||{id:"policy_".concat(Date.now()),name:h.trim(),description:f.trim()||void 0,isDefault:!1,rules:[]},id:"policy_".concat(Date.now()),name:h.trim(),description:f.trim()||void 0,isDefault:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await i([...t,s]),g(!1),y(""),b(""),v(null),d(s.id)}catch(e){console.error("Error creating policy:",e),alert("Failed to create policy. Please try again.")}finally{C(!1)}}async function A(e){let s={...e,id:"policy_".concat(Date.now()),name:"".concat(e.name," (Copy)"),isDefault:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await i([...t,s]),d(s.id)}return p?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)("div",{className:"p-6 text-center text-gray-600",children:"Loading policies..."})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("header",{className:"space-y-1",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Guardrail Policies"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Create reusable guardrail policy profiles that layer on top of Global Guardrails, then assign them to apps, agents, groups, and users."})]}),(0,a.jsxs)(l.z,{onClick:()=>{let e=t.find(e=>e.isDefault)||t[0];v((null==e?void 0:e.id)||null),g(!0)},className:"text-sm",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-plus",className:"h-4 w-4 mr-2"}),"New policy"]})]})}),(0,a.jsx)("section",{className:"rounded-xl border border-gray-100 bg-white shadow-sm",children:0===t.length?(0,a.jsxs)("div",{className:"p-12 text-center",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-shield-halved",className:"h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"No policies yet"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Create your first guardrail policy to get started."}),(0,a.jsxs)(l.z,{onClick:()=>{g(!0)},size:"sm",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-plus",className:"h-3 w-3 mr-1"}),"Create policy"]})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Policy"}),(0,a.jsx)("th",{className:"px-4 py-3 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Default"}),(0,a.jsx)("th",{className:"px-4 py-3 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Rules"}),(0,a.jsx)("th",{className:"px-4 py-3 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Assigned to"}),(0,a.jsx)("th",{className:"px-4 py-3 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Last updated"}),(0,a.jsx)("th",{className:"px-4 py-3 text-[11px] font-medium text-gray-500 uppercase tracking-wider text-right",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]})}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.isDefault?(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1 text-[11px] font-medium text-blue-700",children:"Default"}):(0,a.jsx)("span",{className:"text-[11px] text-gray-400",children:"—"})}),(0,a.jsxs)("td",{className:"px-4 py-3 text-[11px] text-gray-600",children:[e.rules.length," rule",1!==e.rules.length?"s":""]}),(0,a.jsx)("td",{className:"px-4 py-3 text-[11px] text-gray-600",children:function(e,t){let s=t.filter(t=>t.policyId===e);if(0===s.length)return"Not used";let a=s.filter(e=>"app"===e.scope).length,r=s.filter(e=>"agent"===e.scope).length,i=s.filter(e=>"group"===e.scope).length,l=s.filter(e=>"user"===e.scope).length,n=[];return a>0&&n.push("".concat(a," app").concat(a>1?"s":"")),r>0&&n.push("".concat(r," agent").concat(r>1?"s":"")),i>0&&n.push("".concat(i," group").concat(i>1?"s":"")),l>0&&n.push("".concat(l," user").concat(l>1?"s":"")),n.join(", ")||"Not used"}(e.id,s)}),(0,a.jsx)("td",{className:"px-4 py-3 text-[11px] text-gray-600",children:e.updatedAt?new Date(e.updatedAt).toLocaleDateString():e.createdAt?new Date(e.createdAt).toLocaleDateString():"—"}),(0,a.jsx)("td",{className:"px-4 py-3 text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>d(e.id),className:"text-[11px] text-indigo-600 hover:text-indigo-700 font-medium",children:"Edit"}),(0,a.jsx)("button",{type:"button",onClick:()=>A(e),className:"text-[11px] text-gray-600 hover:text-gray-700",children:"Duplicate"}),!e.isDefault&&(0,a.jsx)("button",{type:"button",onClick:()=>{var s;return s=e.id,void i(t.map(e=>({...e,isDefault:e.id===s})))},className:"text-[11px] text-gray-600 hover:text-gray-700",children:"Set default"}),(0,a.jsx)("button",{type:"button",onClick:()=>(function(e){let a=t.find(t=>t.id===e);if(!a)return;if(a.isDefault){alert("Cannot delete the default policy. Please set another policy as default first.");return}if(!confirm('Are you sure you want to delete "'.concat(a.name,'"? This action cannot be undone.')))return;w(e);let r=t.filter(t=>t.id!==e),l=s.filter(t=>t.policyId!==e);i(r),o(l),w(null)})(e.id),disabled:N===e.id,className:"text-[11px] text-red-600 hover:text-red-700 disabled:opacity-50",children:N===e.id?"Deleting...":"Delete"})]})})]},e.id))})]})})})]}),m&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Create New Policy"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:["Name ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(c.I,{type:"text",value:h,onChange:e=>y(e.target.value),placeholder:"e.g., Admissions Policy, Safety Policy",className:"h-8 text-[11px]",autoFocus:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Description (optional)"}),(0,a.jsx)(c.I,{type:"text",value:f,onChange:e=>b(e.target.value),placeholder:"Brief description of this policy",className:"h-8 text-[11px]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Start from"}),(0,a.jsxs)("select",{value:j||"",onChange:e=>v(e.target.value||null),className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"",children:"Empty policy"}),t.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"global",children:"Global Guardrails (current settings)"}),t.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name,e.isDefault?" (Default)":""]},e.id))]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,a.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>{g(!1),y(""),b(""),v(null)},className:"text-[11px]",children:"Cancel"}),(0,a.jsx)(l.z,{size:"sm",onClick:S,disabled:!h.trim()||k,className:"text-[11px]",children:k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-spinner",className:"h-3 w-3 mr-1 animate-spin"}),"Creating..."]}):"Create Policy"})]})]})})]})}function _(e){let{rules:t,entityLabel:s,onChange:i,getTargetOptions:c,isDefault:d=!1,allRules:x=[]}=e,[u,p]=r.useState("All"),[m,g]=r.useState(!1),[h,y]=r.useState({scope:"app",channelScope:"all"}),[f,b]=r.useState(null),j=r.useRef(null),v=r.useMemo(()=>"All"===u?t:t.filter(e=>e.scope===u),[t,u]),N=r.useMemo(()=>[...v].sort((e,t)=>e.order-t.order),[v]),w=r.useMemo(()=>(function(e){let t={user:[],group:[],agent:[],app:[]};return e.forEach(e=>{t[e.scope]&&t[e.scope].push(e)}),Object.keys(t).forEach(e=>{t[e].sort((e,t)=>e.order-t.order)}),t})(t),[t]),k=t.length>0;function C(e,s){i(t.map(t=>t.id===e?{...t,...s}:t))}function S(e,s){let a=t.findIndex(t=>t.id===e);if(-1===a)return;let r=[...t],l="up"===s?a-1:a+1;if(l<0||l>=r.length)return;let n=r[a].order;r[a].order=r[l].order,r[l].order=n;let o=[...r].sort((e,t)=>e.order-t.order);o.forEach((e,t)=>{e.order=t}),i(o)}return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-6 shadow-sm space-y-4",ref:j,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Assignment Rules"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Define how this ",s," is assigned to specific apps, agents, groups, and users."]}),(0,a.jsxs)("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium text-blue-900 mb-1",children:"Assignment priority:"}),(0,a.jsxs)("ol",{className:"text-[10px] text-blue-800 list-decimal list-inside space-y-0.5",children:[(0,a.jsx)("li",{children:"User"}),(0,a.jsx)("li",{children:"Group"}),(0,a.jsx)("li",{children:"Agent"}),(0,a.jsx)("li",{children:"App"}),(0,a.jsxs)("li",{children:["Default ",s]})]}),(0,a.jsx)("p",{className:"text-[10px] text-blue-700 mt-2",children:"When multiple rules match, the most specific rule wins. If rules have equal specificity, the rule with the highest priority (top-most) is applied."})]})]}),(0,a.jsxs)(l.z,{size:"sm",onClick:()=>g(!0),className:"text-[11px] h-7",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-plus",className:"h-3 w-3 mr-1"}),"Add rule"]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:["All","user","group","agent","app"].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>p(e),className:(0,o.cn)("px-3 py-1 rounded-full text-[11px] font-medium transition-colors",u===e?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"All"===e?"All":e.charAt(0).toUpperCase()+e.slice(1)+"s"},e))}),0===N.length?(0,a.jsxs)("div",{className:"text-center py-12 border border-gray-200 rounded-lg bg-gray-50",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-list",className:"h-8 w-8 text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"No assignment rules yet"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mb-4",children:["This ",s," is not assigned to any apps, agents, groups, or users. Create a rule to assign it."]}),(0,a.jsxs)(l.z,{size:"sm",onClick:()=>g(!0),className:"text-[11px]",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-plus",className:"h-3 w-3 mr-1"}),"Add your first rule"]})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Scope"}),(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Target"}),(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Channel"}),(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider text-right",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map((e,s)=>{c(e.scope).find(t=>t.id===e.targetId);let r=f===e.id;return(0,a.jsxs)("tr",{"data-rule-id":e.id,className:(0,o.cn)("hover:bg-gray-50 transition-colors",r&&"bg-slate-100 ring-2 ring-indigo-500"),children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("select",{value:e.scope,onChange:t=>{var s,a;let r=t.target.value,i=c(r);C(e.id,{scope:r,targetId:(null===(s=i[0])||void 0===s?void 0:s.id)||"",targetLabel:(null===(a=i[0])||void 0===a?void 0:a.name)||""})},className:"text-[11px] rounded border border-gray-200 bg-white px-2 py-1 text-gray-900",children:[(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"group",children:"Group"}),(0,a.jsx)("option",{value:"agent",children:"Agent"}),(0,a.jsx)("option",{value:"app",children:"App"})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsx)("select",{value:e.targetId,onChange:t=>{let s=c(e.scope).find(e=>e.id===t.target.value);C(e.id,{targetId:t.target.value,targetLabel:(null==s?void 0:s.name)||""})},className:"text-[11px] rounded border border-gray-200 bg-white px-2 py-1 text-gray-900 min-w-[180px]",children:c(e.scope).map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("select",{value:e.channelScope,onChange:t=>C(e.id,{channelScope:t.target.value}),className:"text-[11px] rounded border border-gray-200 bg-white px-2 py-1 text-gray-900",children:[(0,a.jsx)("option",{value:"all",children:"All channels"}),(0,a.jsx)("option",{value:"chat",children:"Chat only"}),(0,a.jsx)("option",{value:"email",children:"Email only"}),(0,a.jsx)("option",{value:"sms",children:"SMS only"})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{type:"button",onClick:()=>S(e.id,"up"),disabled:0===s,className:"text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-arrow-up",className:"h-3 w-3"})}),(0,a.jsx)("span",{className:"text-[11px] text-gray-600 min-w-[2rem] text-center",children:e.order}),(0,a.jsx)("button",{type:"button",onClick:()=>S(e.id,"down"),disabled:s===N.length-1,className:"text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-arrow-down",className:"h-3 w-3"})})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:(0,a.jsx)("button",{type:"button",onClick:()=>{var s;return s=e.id,void(confirm("Are you sure you want to delete this assignment rule?")&&i(t.filter(e=>e.id!==s)))},className:"text-gray-400 hover:text-red-600",title:"Delete rule",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-trash",className:"h-4 w-4"})})})]},e.id)})})]})})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-6 shadow-sm space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-sm font-semibold text-gray-900 mb-1",children:["Where this ",s," applies"]}),(0,a.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg mt-2",children:(0,a.jsxs)("p",{className:"text-[11px] text-blue-800",children:["This section summarizes the entities where this ",s," is in effect, based on the assignment rules above and default fallback.",d&&(0,a.jsxs)("span",{className:"block mt-1",children:[(0,a.jsx)("strong",{children:"Note:"})," Because this ",s," is marked as the default, it will also apply wherever no specific rule matches."]})]})})]}),k?(0,a.jsx)("div",{className:"space-y-6",children:Object.entries(w).map(e=>{let[t,s]=e;return 0===s.length?null:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-[11px] font-semibold text-gray-700 uppercase tracking-wide",children:function(e){switch(e){case"user":return"Users";case"group":return"Groups";case"agent":return"Agents";case"app":return"Apps"}}(t)}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Channel"}),(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,a.jsx)("th",{className:"px-4 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider text-right",children:"Rule"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsx)("span",{className:"text-[11px] text-gray-900",children:e.targetLabel})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsx)("span",{className:"text-[11px] text-gray-600",children:function(e){switch(e){case"all":return"All channels";case"chat":return"Chat";case"email":return"Email";case"sms":return"SMS";default:return e}}(e.channelScope)})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsx)("span",{className:"text-[11px] text-gray-600",children:e.order})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:(0,a.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void(j.current&&j.current.scrollIntoView({behavior:"smooth",block:"start"}),b(t),setTimeout(()=>{b(null)},2e3))},className:"text-[11px] text-indigo-600 hover:text-indigo-700 font-medium",children:"View rule →"})})]},e.id))})]})})]},t)})}):(0,a.jsxs)("div",{className:"text-center py-12 border border-gray-200 rounded-lg bg-gray-50",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-info-circle",className:"h-8 w-8 text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:d?"Default ".concat(s.charAt(0).toUpperCase()+s.slice(1)):"No Assignment Rules"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:d?(0,a.jsxs)(a.Fragment,{children:["This ",s," is the default ",s,". It applies to all apps, agents, groups, and users where no specific assignment rule matches."]}):(0,a.jsxs)(a.Fragment,{children:["This ",s," has no assignment rules. It will only be used if explicitly selected or if it becomes the default ",s,"."]})}),!d&&(0,a.jsxs)("p",{className:"text-[10px] text-gray-400 mt-2",children:["Create assignment rules above to apply this ",s," to specific entities."]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,a.jsx)("h3",{className:"text-[11px] font-semibold text-gray-700 mb-2",children:"How Assignment Priority Works"}),(0,a.jsxs)("div",{className:"space-y-2 text-[10px] text-gray-600",children:[(0,a.jsx)("p",{children:"Assignment rules are evaluated in order of specificity (most specific to least specific):"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"User"})," - Rules that target a specific user"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Group"})," - Rules that target a group the user belongs to"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Agent"})," - Rules that target a specific AI agent"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"App"})," - Rules that target an application"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Default"})," - The ",s," marked as default (if no rules match)"]})]}),(0,a.jsx)("p",{className:"mt-2",children:"When multiple rules match at the same specificity level, the rule with the highest priority (lowest order number, shown at the top) is applied."})]})]})]}),m&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Add Assignment Rule"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:["Scope ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{value:h.scope||"app",onChange:e=>{var t;return t=e.target.value,void y({...h,scope:t,targetId:void 0})},className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"group",children:"Group"}),(0,a.jsx)("option",{value:"agent",children:"Agent"}),(0,a.jsx)("option",{value:"app",children:"App"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:["Target ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{value:h.targetId||"",onChange:e=>{let t=c(h.scope||"app").find(t=>t.id===e.target.value);y({...h,targetId:e.target.value,targetLabel:(null==t?void 0:t.name)||""})},className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsxs)("option",{value:"",children:["Select ",h.scope,"..."]}),c(h.scope||"app").map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Channel"}),(0,a.jsxs)("select",{value:h.channelScope||"all",onChange:e=>y({...h,channelScope:e.target.value}),className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"all",children:"All channels"}),(0,a.jsx)("option",{value:"chat",children:"Chat only"}),(0,a.jsx)("option",{value:"email",children:"Email only"}),(0,a.jsx)("option",{value:"sms",children:"SMS only"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,a.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>{g(!1),y({scope:"app",channelScope:"all"})},className:"text-[11px]",children:"Cancel"}),(0,a.jsx)(l.z,{size:"sm",onClick:function(){if(!h.scope||!h.targetId)return;let e=c(h.scope).find(e=>e.id===h.targetId),s=t.length>0?Math.max(...t.map(e=>e.order)):-1;i([...t,{...h,id:"assignment_rule_".concat(Date.now()),scope:h.scope,targetId:h.targetId,targetLabel:(null==e?void 0:e.name)||"",channelScope:h.channelScope||"all",order:s+1}]),g(!1),y({scope:"app",channelScope:"all"})},disabled:!h.scope||!h.targetId,className:"text-[11px]",children:"Add Rule"})]})]})})]})}let E=[{id:"overview",label:"Overview"},{id:"rules",label:"Rules"},{id:"assignments",label:"Assignments"},{id:"preview",label:"Preview"}],P=[{id:"app-1",name:"Admissions AI Assistant"},{id:"app-2",name:"Student Success Coach"},{id:"app-3",name:"Athletics Bot"},{id:"app-advancement",name:"Advancement AI Assistant"}],F=[{id:"agent-1",name:"Donor AI Agent"},{id:"agent-2",name:"Alumni Engagement Agent"},{id:"agent-3",name:"Student Support Agent"}],R=[{id:"group-1",name:"Admissions counselors"},{id:"group-2",name:"Advancement team"},{id:"group-3",name:"Athletics staff"}],q=[{id:"user-1",name:"Jane Smith"},{id:"user-2",name:"Jordan Lee"},{id:"user-3",name:"Alex Martin"},{id:"user-4",name:"Taylor Singh"}];function M(e){switch(e){case"app":return P;case"agent":return F;case"group":return R;case"user":return q}}function O(e){let{policy:t,allPolicies:s,assignmentRules:n,allAssignmentRules:c,onUpdatePolicy:d,onUpdatePolicies:x,onUpdateAssignmentRules:u,onDeletePolicy:p,onSave:m,basePath:g="/admin/guardrails",onBack:h}=e,y=(0,i.useRouter)(),[f,b]=r.useState("overview"),[j,v]=r.useState(t),[N,w]=r.useState(!1),[k,C]=r.useState(!1),[S,A]=r.useState({channel:"all"});function I(e){v(e),w(!0)}async function D(){C(!0);try{d(j),await m(),w(!1)}catch(e){console.error("Error saving policy:",e),alert("Failed to save policy. Please try again.")}finally{C(!1)}}async function _(){let e=s.map(e=>({...e,isDefault:e.id===t.id}));await x(e),I(e=>({...e,isDefault:!0}));try{await m()}catch(e){console.error("Error saving default policy:",e)}}r.useEffect(()=>{v(t),w(!1)},[t.id]);let P=r.useMemo(()=>{try{return function(e,t,s){let a=t;for(let e of(s.channel&&(a=t.filter(e=>"all"===e.channelScope||e.channelScope===s.channel)),["user","group","agent","app"])){let t=a.filter(t=>{if(t.scope!==e)return!1;switch(e){case"user":return s.userId&&t.targetId===s.userId;case"group":return s.groupIds&&s.groupIds.includes(t.targetId);case"agent":return s.agentId&&t.targetId===s.agentId;case"app":return s.appId&&t.targetId===s.appId;default:return!1}});if(t.length>0){t.sort((e,t)=>e.order-t.order);let e=t[0];return{policyId:e.policyId,source:"rule",ruleId:e.id,scope:e.scope}}}let r=e.find(e=>e.isDefault);if(r)return{policyId:r.id,source:"default"};if(e.length>0)return{policyId:e[0].id,source:"default"};throw Error("No guardrail policies available for resolution")}(s,c,S)}catch(e){return null}},[s,c,S]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("nav",{className:"text-sm text-gray-600",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{h?h():y.push("".concat(g,"?tab=policies"))},className:"hover:text-gray-900",children:"Guardrails"}),(0,a.jsx)("span",{className:"mx-2",children:"/"}),(0,a.jsx)("button",{type:"button",onClick:()=>{h?h():y.push("".concat(g,"?tab=policies"))},className:"hover:text-gray-900",children:"Policies"}),(0,a.jsx)("span",{className:"mx-2",children:"/"}),(0,a.jsx)("span",{className:"text-gray-900",children:j.name})]}),(0,a.jsx)("header",{className:"space-y-1",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:j.name}),j.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:j.description}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This policy layers on top of Global Guardrails."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[j.isDefault?(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1 text-xs font-medium text-blue-700",children:"Default"}):(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:_,className:"text-xs",children:"Set as default"}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:function(){let e={...j,id:"policy_".concat(Date.now()),name:"".concat(j.name," (Copy)"),isDefault:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};x([...s,e]),h&&h(),y.push("".concat(g,"?tab=policies&policyId=").concat(e.id))},className:"text-xs",children:"Duplicate"}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:function(){if(j.isDefault){alert("Cannot delete the default policy. Please set another policy as default first.");return}confirm('Are you sure you want to delete "'.concat(j.name,'"? This action cannot be undone.'))&&(p(j.id),h?h():y.push("".concat(g,"?tab=policies")))},className:"text-xs text-red-600 hover:text-red-700",children:"Delete"}),(0,a.jsx)(l.z,{onClick:D,disabled:!N||k,className:"text-xs",children:k?"Saving...":"Save changes"})]})]})}),(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:E.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>b(e.id),className:(0,o.cn)("whitespace-nowrap border-b-2 py-2 px-1 text-sm font-medium transition-colors",f===e.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:e.label},e.id))})}),(0,a.jsxs)("div",{className:"mt-6",children:["overview"===f&&(0,a.jsx)(G,{policy:j,onUpdate:I}),"rules"===f&&(0,a.jsx)(z,{policy:j,onUpdate:I}),"assignments"===f&&(0,a.jsx)(T,{policy:j,rules:n,allRules:c,onUpdateRules:u}),"preview"===f&&(0,a.jsx)(H,{policy:j,allPolicies:s,allRules:c,previewContext:S,onUpdateContext:A,previewResult:P})]})]})}function G(e){let{policy:t,onUpdate:s}=e,[i,l]=r.useState(t.name),[n,o]=r.useState(t.description||""),[d,x]=r.useState(t.isDefault);return r.useEffect(()=>{l(t.name),o(t.description||""),x(t.isDefault)},[t.id]),(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-6 shadow-sm space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900 mb-1",children:"How this policy works"}),(0,a.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2 text-xs text-blue-900",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:"1."}),(0,a.jsx)("span",{children:"Global Guardrails define mandatory safety, fairness, privacy, and escalation rules."})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:"2."}),(0,a.jsx)("span",{children:"This policy can tighten or tailor behavior for specific apps, agents, groups, or users."})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:"3."}),(0,a.jsx)("span",{children:"Assignments determine where this policy is used."})]})]}),(0,a.jsx)("div",{className:"pt-2 border-t border-blue-200",children:(0,a.jsx)("p",{className:"text-xs font-medium text-blue-900",children:"Final behavior = Global Guardrails + assigned policy for the context"})})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Policy Settings"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-4",children:"Configure basic policy information and default status."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:["Name ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(c.I,{type:"text",value:i,onChange:e=>{var t;l(t=e.target.value),s(e=>({...e,name:t}))},placeholder:"e.g., Admissions Policy, Safety Policy",className:"text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{value:n,onChange:e=>{var t;o(t=e.target.value),s(e=>({...e,description:t||void 0}))},placeholder:"Brief description of this policy",rows:3,className:"w-full rounded border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-100",children:[(0,a.jsx)("input",{type:"checkbox",checked:d,onChange:e=>{var t;x(t=e.target.checked),s(e=>({...e,isDefault:t}))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("label",{className:"text-sm text-gray-700 cursor-pointer",children:"Set as default policy"})]}),(0,a.jsxs)("div",{className:"pt-2 border-t border-gray-100",children:[(0,a.jsxs)("p",{className:"text-[10px] text-gray-500",children:["Policy ID: ",(0,a.jsx)("code",{className:"text-gray-600",children:t.id})]}),(0,a.jsx)("p",{className:"text-[10px] text-gray-500 mt-2",children:"Guardrail policies define safety, fairness, and compliance rules for your AI assistants. Each policy can be mapped to specific apps, agents, groups, or users using Assignment Rules."})]})]})]})}function z(e){let{policy:t,onUpdate:s}=e;function r(){let e={id:"rule_".concat(Date.now()),category:"custom",description:"",action:"block",enabled:!0};s(t=>({...t,rules:[...t.rules,e]}))}function i(e,t){s(s=>({...s,rules:s.rules.map(s=>s.id===e?{...s,...t}:s)}))}return(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-6 shadow-sm space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Guardrail Rules"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Define the specific guardrail rules that make up this policy."}),(0,a.jsx)("div",{className:"mt-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-[11px] text-amber-800",children:"These rules tailor behavior for this policy. Core safety and privacy requirements from Global Guardrails still apply and are not removed here."})})]}),(0,a.jsxs)(l.z,{size:"sm",onClick:r,className:"text-[11px] h-7",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-plus",className:"h-3 w-3 mr-1"}),"Add rule"]})]}),0===t.rules.length?(0,a.jsxs)("div",{className:"text-center py-12 border border-gray-200 rounded-lg bg-gray-50",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-shield-halved",className:"h-8 w-8 text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"No rules yet"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Add guardrail rules to define what this policy enforces."}),(0,a.jsxs)(l.z,{size:"sm",onClick:r,className:"text-[11px]",children:[(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-plus",className:"h-3 w-3 mr-1"}),"Add your first rule"]})]}):(0,a.jsx)("div",{className:"space-y-3",children:t.rules.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:t=>i(e.id,{enabled:t.target.checked}),className:"rounded border-gray-300 text-indigo-600"}),(0,a.jsxs)("select",{value:e.category,onChange:t=>i(e.id,{category:t.target.value}),className:"text-[11px] rounded border border-gray-200 bg-white px-2 py-1 text-gray-900",children:[(0,a.jsx)("option",{value:"safety",children:"Safety"}),(0,a.jsx)("option",{value:"compliance",children:"Compliance"}),(0,a.jsx)("option",{value:"brand",children:"Brand"}),(0,a.jsx)("option",{value:"custom",children:"Custom"})]}),(0,a.jsxs)("select",{value:e.action,onChange:t=>i(e.id,{action:t.target.value}),className:"text-[11px] rounded border border-gray-200 bg-white px-2 py-1 text-gray-900",children:[(0,a.jsx)("option",{value:"block",children:"Block"}),(0,a.jsx)("option",{value:"rewrite",children:"Rewrite"}),(0,a.jsx)("option",{value:"escalate",children:"Escalate"}),(0,a.jsx)("option",{value:"log",children:"Log"})]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void s(e=>({...e,rules:e.rules.filter(e=>e.id!==t)}))},className:"text-gray-400 hover:text-red-600",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-trash",className:"h-4 w-4"})})]}),(0,a.jsx)("textarea",{value:e.description||"",onChange:t=>i(e.id,{description:t.target.value}),placeholder:"Rule description...",rows:2,className:"w-full rounded border border-gray-200 bg-white px-3 py-2 text-[11px] text-gray-900"})]},e.id))})]})}function T(e){let{policy:t,rules:s,allRules:r,onUpdateRules:i}=e;return(0,a.jsx)(_,{rules:s,entityLabel:"policy",onChange:e=>{i(e.map(e=>({...e,policyId:t.id,scope:e.scope,channelScope:e.channelScope})))},getTargetOptions:M,isDefault:t.isDefault,allRules:r})}function H(e){var t;let{policy:s,allPolicies:r,allRules:i,previewContext:l,onUpdateContext:o,previewResult:c}=e;return(0,a.jsxs)("section",{className:"rounded-xl border border-gray-100 bg-white p-6 shadow-sm space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Preview / Test"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Test which policy would be applied for a given context."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"App"}),(0,a.jsxs)("select",{value:l.appId||"",onChange:e=>o({...l,appId:e.target.value||void 0}),className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"",children:"None"}),P.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Agent"}),(0,a.jsxs)("select",{value:l.agentId||"",onChange:e=>o({...l,agentId:e.target.value||void 0}),className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"",children:"None"}),F.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"User"}),(0,a.jsxs)("select",{value:l.userId||"",onChange:e=>o({...l,userId:e.target.value||void 0}),className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"",children:"None"}),q.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] font-medium text-gray-700 mb-1",children:"Channel"}),(0,a.jsxs)("select",{value:l.channel||"all",onChange:e=>o({...l,channel:e.target.value}),className:"w-full rounded border border-gray-200 bg-white px-2 py-1.5 text-[11px] text-gray-900",children:[(0,a.jsx)("option",{value:"all",children:"All channels"}),(0,a.jsx)("option",{value:"chat",children:"Chat"}),(0,a.jsx)("option",{value:"email",children:"Email"}),(0,a.jsx)("option",{value:"sms",children:"SMS"})]})]})]}),c&&(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Effective guardrail stack for this context"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-[10px] font-semibold",children:"1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-blue-900",children:"Global Guardrails"}),(0,a.jsx)("p",{className:"text-[11px] text-blue-700 mt-0.5",children:"Always on baseline"})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center text-blue-400",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-arrow-down",className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-indigo-600 text-white flex items-center justify-center text-[10px] font-semibold",children:"2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-blue-900",children:(null===(t=r.find(e=>e.id===c.policyId))||void 0===t?void 0:t.name)||c.policyId}),(0,a.jsxs)("p",{className:"text-[11px] text-blue-700 mt-0.5",children:["Selected by ","rule"===c.source?"".concat(c.scope,"-level assignment rule"):"default policy"]})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center text-blue-400",children:(0,a.jsx)(n.FontAwesomeIcon,{icon:"fa-solid fa-arrow-down",className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-green-600 text-white flex items-center justify-center text-[10px] font-semibold",children:"3"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-blue-900",children:"Final behavior"}),(0,a.jsx)("p",{className:"text-[11px] text-blue-700 mt-0.5",children:"Intersection of Global Guardrails and this policy"})]})]})]})]}),c.ruleId&&(0,a.jsx)("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:(0,a.jsxs)("div",{className:"space-y-1 text-[11px] text-gray-600",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Rule ID:"})," ",c.ruleId]}),c.scope&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Scope:"})," ",c.scope]})]})})]})]})]})}let L=[{id:"global",label:"Global Guardrails"},{id:"policies",label:"Policies"}];function W(e){let{context:t="admin"}=e,l=(0,i.useRouter)(),n=(0,i.useSearchParams)(),[c,d]=r.useState([]),[x,u]=r.useState([]),[p,m]=r.useState(!0),[g,h]=r.useState(()=>"policies"===n.get("tab")?"policies":"global"),[y,f]=r.useState(()=>n.get("policyId")||null);async function b(){try{m(!0);let{getMockGuardrailPolicies:e,getMockGuardrailAssignmentRules:t}=await s.e(2622).then(s.bind(s,2622));d(e()),u(t())}catch(e){console.error("Error loading policies:",e)}finally{m(!1)}}async function j(e){d(e)}async function v(e){u(e)}r.useEffect(()=>{let e=n.get("tab"),t=n.get("policyId");"policies"===e?h("policies"):h("global"),t?f(t):f(null)},[n]),r.useEffect(()=>{b()},[]),r.useEffect(()=>{let e=new URLSearchParams;"global"!==g&&e.set("tab",g),y&&e.set("policyId",y);let t=e.toString(),s=t?"".concat(window.location.pathname,"?").concat(t):window.location.pathname;l.replace(s,{scroll:!1})},[g,y,l]);let N="admin"===t?"/admin/guardrails":"/ai-assistants/guardrails";if(y){let e=c.find(e=>e.id===y);if(e){let t=x.filter(e=>e.policyId===y);return(0,a.jsx)(O,{policy:e,allPolicies:c,assignmentRules:t,allAssignmentRules:x,onUpdatePolicy:e=>{d(c.map(t=>t.id===e.id?e:t))},onUpdatePolicies:j,onUpdateAssignmentRules:e=>{v([...x.filter(e=>e.policyId!==y),...e])},onDeletePolicy:e=>{d(c.filter(t=>t.id!==e)),u(x.filter(t=>t.policyId!==e)),f(null)},onSave:async()=>{await j(c),await v(x)},basePath:N,onBack:function(){f(null)}})}}return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("header",{className:"space-y-1",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Guardrails"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"global"===g?"Define baseline safety, fairness, privacy, and escalation rules that apply to all assistants, apps, agents, groups, and users.":"Create reusable guardrail policy profiles that layer on top of Global Guardrails, then assign them to apps, agents, groups, and users."})]}),"policies"===g&&(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1 text-xs font-medium text-blue-700",children:"Admin only"})]})}),(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:L.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>{h(e.id),"policies"===e.id&&f(null)},className:(0,o.cn)("whitespace-nowrap border-b-2 py-2 px-1 text-sm font-medium transition-colors",g===e.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:e.label},e.id))})}),(0,a.jsxs)("div",{className:"mt-6",children:["global"===g&&(0,a.jsx)(I,{}),"policies"===g&&(0,a.jsx)(D,{policies:c,assignmentRules:x,onUpdatePolicies:j,onUpdateAssignmentRules:v,onSelectPolicy:function(e){f(e),h("policies")},onCreatePolicy:function(){h("policies"),f(null)},basePath:N,loading:p})]})]})}},2869:function(e,t,s){s.d(t,{z:function(){return c}});var a=s(7437),r=s(2265),i=s(7495),l=s(535),n=s(4508);let o=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:c=!1,...d}=e,x=c?i.g7:"button";return(0,a.jsx)(x,{className:(0,n.cn)(o({variant:r,size:l,className:s})),ref:t,...d})});c.displayName="Button"},7604:function(e,t,s){s.d(t,{FontAwesomeIcon:function(){return r}});var a=s(7437);function r(e){let{icon:t,className:s="",size:r,style:i,"aria-hidden":l=!0}=e,n="".concat(t," ").concat(s).trim();return(0,a.jsx)("span",{style:{display:"contents",...i},"aria-hidden":l,children:(0,a.jsx)("i",{className:n,suppressHydrationWarning:!0})})}},5186:function(e,t,s){s.d(t,{I:function(){return l}});var a=s(7437),r=s(2265),i=s(4508);let l=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...l})});l.displayName="Input"},4508:function(e,t,s){s.d(t,{cn:function(){return i}});var a=s(1994),r=s(3335);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},9376:function(e,t,s){var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8575:function(e,t,s){s.d(t,{F:function(){return i},e:function(){return l}});var a=s(2265);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function i(...e){return t=>{let s=!1,a=e.map(e=>{let a=r(e,t);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let t=0;t<a.length;t++){let s=a[t];"function"==typeof s?s():r(e[t],null)}}}}function l(...e){return a.useCallback(i(...e),e)}},7495:function(e,t,s){s.d(t,{Z8:function(){return l},g7:function(){return n}});var a=s(2265),r=s(8575),i=s(7437);function l(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:s,...i}=e;if(a.isValidElement(s)){let e,l;let n=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?s.props.ref:s.props.ref||s.ref,o=function(e,t){let s={...t};for(let a in t){let r=e[a],i=t[a];/^on[A-Z]/.test(a)?r&&i?s[a]=(...e)=>{let t=i(...e);return r(...e),t}:r&&(s[a]=r):"style"===a?s[a]={...r,...i}:"className"===a&&(s[a]=[r,i].filter(Boolean).join(" "))}return{...e,...s}}(i,s.props);return s.type!==a.Fragment&&(o.ref=t?(0,r.F)(t,n):n),a.cloneElement(s,o)}return a.Children.count(s)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),s=a.forwardRef((e,s)=>{let{children:r,...l}=e,n=a.Children.toArray(r),o=n.find(c);if(o){let e=o.props.children,r=n.map(t=>t!==o?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...l,ref:s,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,i.jsx)(t,{...l,ref:s,children:r})});return s.displayName=`${e}.Slot`,s}var n=l("Slot"),o=Symbol("radix.slottable");function c(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},535:function(e,t,s){s.d(t,{j:function(){return l}});var a=s(1994);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=a.W,l=(e,t)=>s=>{var a;if((null==t?void 0:t.variants)==null)return i(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:l,defaultVariants:n}=t,o=Object.keys(l).map(e=>{let t=null==s?void 0:s[e],a=null==n?void 0:n[e];if(null===t)return null;let i=r(t)||r(a);return l[e][i]}),c=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return i(e,o,null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...c}[t]):({...n,...c})[t]===s})?[...e,s,a]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}}}]);